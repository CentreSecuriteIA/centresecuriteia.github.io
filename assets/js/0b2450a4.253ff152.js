"use strict";(self.webpackChunkatlas=self.webpackChunkatlas||[]).push([[5475],{3859:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>p,default:()=>b,frontMatter:()=>m,metadata:()=>i,toc:()=>g});const i=JSON.parse('{"id":"chapters/01/4","title":"Scaling","description":"In the previous section, we explored how we can measure AI capabilities along continuous dimensions of performance and generality. Now we\'ll examine one of the most important drivers behind improvements in these capabilities: scale.","source":"@site/docs/chapters/01/04.md","sourceDirName":"chapters/01","slug":"/chapters/01/04","permalink":"/chapters/01/04","draft":false,"unlisted":false,"editUrl":"https://github.com/markov-root/atlas/edit/main/docs/chapters/01/04.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"4","title":"Scaling","sidebar_label":"1.4 Scaling","sidebar_position":5,"slug":"/chapters/01/04","reading_time_core":"14 min","reading_time_optional":"6 min","pagination_prev":"chapters/01/3","pagination_next":"chapters/01/5"},"sidebar":"docs","previous":{"title":"1.3 Intelligence","permalink":"/chapters/01/03"},"next":{"title":"1.5 Forecasting","permalink":"/chapters/01/05"}}');var n=a(4848),s=a(8453),o=a(3989),r=a(3931),l=a(2482),d=a(8559),h=a(1966),c=a(2501);const m={id:4,title:"Scaling",sidebar_label:"1.4 Scaling",sidebar_position:5,slug:"/chapters/01/04",reading_time_core:"14 min",reading_time_optional:"6 min",pagination_prev:"chapters/01/3",pagination_next:"chapters/01/5"},p="Scaling",u={},g=[{value:"The Bitter Lesson",id:"01",level:2},{value:"Scaling Laws",id:"02",level:2},{value:"Scaling Hypothesis",id:"03",level:2}];function f(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{GlossaryTerm:a}=t;return a||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("GlossaryTerm",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"scaling",children:"Scaling"})}),"\n",(0,n.jsx)(t.p,{children:"In the previous section, we explored how we can measure AI capabilities along continuous dimensions of performance and generality. Now we'll examine one of the most important drivers behind improvements in these capabilities: scale."}),"\n",(0,n.jsx)(t.h2,{id:"01",children:"The Bitter Lesson"}),"\n",(0,n.jsxs)(t.p,{children:["We assume that most of you probably went to university in an era where ",(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:"machine learning"})})," and AI roughly mean the same thing, or rather ",(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:"deep learning"})})," and AI mean the same thing. This hasn't always been true. Early in the history of artificial intelligence, researchers took very different approaches to creating intelligent systems. They believed that the key to artificial intelligence was carefully encoding human knowledge and expertise into computer programs. This led to things like expert systems filled with hand-crafted rules and chess engines programmed with sophisticated strategic principles. However, time and time again, researchers learned what we now call the bitter lesson."]}),"\n",(0,n.jsx)(l.A,{speaker:"Richard Sutton",position:"Professor University of Alberta, Founder, Openmind Research Institute",date:"2019",source:"([Sutton, 2019](http://www.incompleteideas.net/IncIdeas/BitterLesson.html))",children:(0,n.jsx)(t.p,{children:"The biggest lesson that can be read from 70 years of AI research is that general methods that leverage computation are ultimately the most effective, and by a large margin. [...] The bitter lesson is based on the historical observations that 1) AI researchers have often tried to build knowledge into their agents, 2) this always helps in the short term, and is personally satisfying to the researcher, but 3) in the long run it plateaus and even inhibits further progress, and 4) breakthrough progress eventually arrives by an opposing approach based on scaling computation by search and learning."})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What makes this lesson bitter?"}),' The bitterness comes from discovering that decades of careful human engineering and insight were ultimately less important than simple algorithms plus computation. In chess, researchers who had spent years encoding grandmaster knowledge watched as "brute force" search-based approaches like Deep Blue defeated world champion Garry Kasparov. In computer vision, hand-crafted feature detectors were outperformed by convolutional neural networks that learned their own features from data. In speech recognition, systems based on human understanding of phonetics were surpassed by statistical approaches using hidden Markov models (',(0,n.jsx)(t.a,{href:"http://www.incompleteideas.net/IncIdeas/BitterLesson.html",children:"Sutton, 2019"}),")."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Does the bitter lesson mean we don't need any human engineering?"})," Human ingenuity playing a smaller role in improving AI is a subtle point that can be easily misunderstood. The ",(0,n.jsx)(a,{term:"transformer",definition:'{"definition":"A neural network architecture that uses attention mechanisms to process sequential data, particularly effective for language tasks.","source":"[Vaswani et al., 2017](https://arxiv.org/abs/1706.03762)","aliases":["Transformer"]}',children:(0,n.jsx)(a,{term:"transformer",definition:'{"definition":"A neural network architecture that uses attention mechanisms to process sequential data, particularly effective for language tasks.","source":"[Vaswani et al., 2017](https://arxiv.org/abs/1706.03762)","aliases":["Transformer"]}',children:"transformer"})})," architecture for example might seem to contradict the bitter lesson because they rely on sophisticated architectural innovations. Human ingenuity is important, but the subtlety is in recognizing that there's a difference between two types of human engineering:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Algorithm-level improvements:"})," These make better use of existing compute, like: better optimizers (Adam), architecture innovations (transformers, ",(0,n.jsx)(a,{term:"attention",definition:'{"definition":"A mechanism that allows models to focus on relevant parts of the input when making predictions, computing weighted combinations of input elements.","source":"[Bahdanau et al., 2015](https://arxiv.org/abs/1409.0473)","aliases":["Attention","attention mechanism","self-attention"]}',children:(0,n.jsx)(a,{term:"attention",definition:'{"definition":"A mechanism that allows models to focus on relevant parts of the input when making predictions, computing weighted combinations of input elements.","source":"[Bahdanau et al., 2015](https://arxiv.org/abs/1409.0473)","aliases":["Attention","attention mechanism","self-attention"]}',children:"attention"})})," mechanisms) or training approaches (better ",(0,n.jsx)(a,{term:"learning rate",definition:'{"definition":"A hyperparameter that controls how much the model parameters are updated during each step of gradient descent.","source":"","aliases":["Learning Rate"]}',children:(0,n.jsx)(a,{term:"learning rate",definition:'{"definition":"A hyperparameter that controls how much the model parameters are updated during each step of gradient descent.","source":"","aliases":["Learning Rate"]}',children:"learning rate"})})," schedules)."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Domain-specific engineering improvements:"})," These try to encode human knowledge, like: special architectures designed for specific problems, hand-crafted features or rules or task-specific inductive biases."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The bitter lesson isn't arguing against all human engineering - it's specifically cautioning against the second type. The ",(0,n.jsx)(a,{term:"transformer",definition:'{"definition":"A neural network architecture that uses attention mechanisms to process sequential data, particularly effective for language tasks.","source":"[Vaswani et al., 2017](https://arxiv.org/abs/1706.03762)","aliases":["Transformer"]}',children:(0,n.jsx)(a,{term:"transformer",definition:'{"definition":"A neural network architecture that uses attention mechanisms to process sequential data, particularly effective for language tasks.","source":"[Vaswani et al., 2017](https://arxiv.org/abs/1706.03762)","aliases":["Transformer"]}',children:"transformer"})})," architecture exemplifies this pattern - it doesn't encode any specific knowledge about language, but rather provides a general mechanism for learning patterns that becomes increasingly powerful as we scale up compute and data."]}),"\n",(0,n.jsx)(t.h2,{id:"02",children:"Scaling Laws"}),"\n",(0,n.jsx)(r.A,{type:"youtube",videoId:"5eqRuVp65eY",number:"3",label:"1.3",caption:"Optional video explanation of scaling laws."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Why do AI labs care about scaling laws?"})," Training large AI models is extremely expensive - potentially hundreds of millions of dollars for frontier models. Scaling laws help labs make crucial decisions about resource allocation: Should they spend more on GPUs or on acquiring ",(0,n.jsx)(a,{term:"training set",definition:'{"definition":"The portion of data used to train a machine learning model by adjusting its parameters.","source":"","aliases":["Training Set","training data"]}',children:(0,n.jsx)(a,{term:"training set",definition:'{"definition":"The portion of data used to train a machine learning model by adjusting its parameters.","source":"","aliases":["Training Set","training data"]}',children:"training data"})}),"? Should they train a larger model for less time or a smaller model for longer? For example, with a fixed compute budget, they might need to choose between training a 20-billion parameter model on 40% of their data or a 200-billion parameter model on just 4%. Getting these tradeoffs wrong can waste enormous resources. So it is important to be able to have a predictable relationship between how you invest your money and what level of capabilities you get at the end."]}),"\n",(0,n.jsx)(c.A,{src:"./img/rWX_Image_28.png",alt:"Enter image alt description",number:"21",label:"1.21",caption:"Example of capabilities increasing with an increase with one of variables in the scaling laws - parameter count. The same model architecture (Parti) was used to generate an image using an identical prompt, with the only difference between the models being the parameter size. There are noticeable leaps in quality, and somewhere between 3 billion and 20 billion parameters, the model acquires the ability to spell words correctly. ([Yu et al., 2022](https://arxiv.org/abs/2206.10789))"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What are scaling laws?"})," Scaling laws are mathematical relationships that describe how an AI system's performance changes as we vary key inputs like model size, dataset size, and computing power. These are empirical power-law relationships that have been observed to hold across many orders of magnitude. The key variables involved are:"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Compute (C):"}),' This represents the total processing power used during training, measured in floating-point operations (FLOPs). Think of this as the training "budget" - more compute means either training for longer, using more powerful hardware, or both. While having more GPUs helps increase compute capacity, compute ultimately refers to the total number of operations performed, not just hardware.']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Parameters (N):"})," These are the tunable numbers in the model that get adjusted during training - like knobs that the model can adjust to better fit the data. More parameters allow the model to learn more complex patterns but require more compute per training step. Current frontier models have hundreds of billions of parameters."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Dataset size (D):"}),' This measures how many examples the model trains on (typically measured in tokens for language models). The larger the dataset, the more information the model can read. Simultaneously, to read and learn from more data, the training runs also need to be generally longer, which in turn increases the total compute needed before the model can be considered "trained".']}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Loss (L):"})," This measures how well the model performs on its training objective. This is what we are trying to minimize, and it tends to improve as we scale up these variables."]}),"\n",(0,n.jsx)(c.A,{src:"./img/nQO_Image_18.png",alt:"Enter image alt description",number:"22",label:"1.22",caption:"Language modeling performance improves smoothly as we increase the model size, dataset set size, and amount of compute used for training. For optimal performance all three factors must be scaled up in tandem. Empirical performance has a power-law relationship with each individual factor when not bottlenecked by the other two. ([Kaplan et al., 2020](https://arxiv.org/abs/2001.08361))"}),"\n",(0,n.jsx)(o.A,{src:"https://www.metaculus.com/questions/embed/4055",width:"100%",height:"600px",loading:"lazy",frameBorder:"0",number:"8",label:"1.8",caption:"Prediction market results on - Will the first AGI be based on deep learning? ([Metaculus, 2020](https://www.metaculus.com/questions/4055/first-agi-based-on-deep-learning/))"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"OpenAI's initial scaling laws in 2020."})," To determine the relationships between different variables that might contribute to scale, OpenAI conducted a series of experiments. For an intuitive idea of how they came up with the scaling laws, you can imagine that while training a model you can hold some variables fixed while varying others and see how loss changes. Eventually this allows you to see some patterns. As an example, dataset size can be kept constant, while parameter count and training time are varied, or parameter count is kept constant and data amounts are varied, etc\u2026 So we can get a measurement of the relative contribution of each towards overall performance. If these relationships hold true across many different model architectures and tasks, then this suggests they capture something fundamental about ",(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:"deep learning"})})," systems. This is how the first generation of scaling laws came about from OpenAI. For example, by these laws if you have a 10x more compute, you should increase model size by about 5x and data size by only 2x. (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2001.08361",children:"Kaplan et al., 2020"}),")"]}),"\n",(0,n.jsx)(c.A,{src:"./img/o2j_Image_19.png",alt:"Enter image alt description",number:"23",label:"1.23",caption:"OpenAIs initial paper on scaling laws stated that for optimally compute-efficient training, most of the increase should go towards increased model size. A relatively small increase in data is needed to avoid reuse. ([Kaplan et al., 2020](https://arxiv.org/abs/2001.08361))"}),"\n",(0,n.jsx)(o.A,{src:"https://ourworldindata.org/grapher/exponential-growth-of-parameters-in-notable-ai-systems?tab=chart",width:"100%",height:"600px",loading:"lazy",allow:"web-share; clipboard-write",frameBorder:"0",number:"9",label:"1.9",caption:"Exponential growth of parameters in notable AI systems. Parameters are variables in an AI system whose values are adjusted during training to establish how input data gets transformed into the desired output; for example, the connection weights in an artificial neural network ([Giattino et al., 2023](https://ourworldindata.org/artificial-intelligence))."}),"\n",(0,n.jsx)(o.A,{src:"https://ourworldindata.org/grapher/exponential-growth-of-datapoints-used-to-train-notable-ai-systems?tab=chart",width:"100%",height:"600px",loading:"lazy",allow:"web-share; clipboard-write",frameBorder:"0",number:"10",label:"1.10",caption:"Exponential growth of datapoints used to train notable AI systems. Each domain has a specific data point unit; for example, for vision it is images, for language it is words, and forgames it is timesteps. This means systems can only be compared directly within the same domain ([Giattino et al., 2023](https://ourworldindata.org/artificial-intelligence))."}),"\n",(0,n.jsx)(o.A,{src:"https://ourworldindata.org/grapher/exponential-growth-of-computation-in-the-training-of-notable-ai-systems?tab=chart",width:"100%",height:"600px",loading:"lazy",allow:"web-share; clipboard-write",frameBorder:"0",number:"11",label:"1.11",caption:"Exponential growth of computation in the training of notable AI systems. Computation is measured in total peta FLOP, which is 10e15 floating-point operations ([Giattino et al., 2023](https://ourworldindata.org/artificial-intelligence))."}),"\n",(0,n.jsx)(o.A,{src:"https://ourworldindata.org/grapher/artificial-intelligence-training-computation?tab=chart",width:"100%",height:"600px",loading:"lazy",allow:"web-share; clipboard-write",frameBorder:"0",number:"12",label:"1.12",caption:"Computation used to train notable artificial intelligence systems, by domain. Computation is measured in total petaFLOP, which is 10e15 floating-point operations. Estimated from AI literature, albeit with some uncertainty. Estimates are expected to be accurate within a factor of 2, or a factor of 5 for recent undisclosed models like GPT-4 ([Giattino et al., 2023](https://ourworldindata.org/artificial-intelligence))."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"DeepMind's scaling law update in 2022."})," DeepMind found that most large language models were actually significantly overparameterized for the amount of data they were trained on. The Chinchilla scaling laws showed that for optimal performance, models should be trained on approximately 20 times more data tokens than they have parameters. This meant that many leading models could have achieved better performance with smaller sizes, but with more data. They were called chinchilla scaling laws because the laws were demonstrated using a model called Chinchilla. This was a 70B parameter model trained on more data, which outperformed much larger models like Gopher (280B parameters) despite using the same amount of compute. So by these laws, for optimal performance, you should increase model size and dataset size in roughly equal proportions - if you get 10x more compute, you should make your model ~3.1x bigger and your data ~3.1x bigger (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2203.15556",children:"Hoffmann et al., 2022"}),")."]}),"\n",(0,n.jsxs)(d.A,{title:"The Broken Neural Scaling Laws (BNSL) update in 2023",collapsed:!0,children:[(0,n.jsxs)(t.p,{children:['Research showed that performance doesn\'t always improve smoothly - there can be sharp transitions, temporary plateaus, or even periods where performance gets worse before getting better. Examples of this include things like "Grokking", where models suddenly achieve strong generalization after many training steps, or deep double descent, where increasing model size initially hurts then helps performance. Rather than simple power laws, BNSL uses a more flexible functional form that can capture these complex behaviors. This allows for more accurate predictions of scaling behavior, particularly around discontinuities and transitions. Scaling laws are a good baseline, but discontinuous jumps in capabilities and abrupt step changes are still possible (',(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2210.14891",children:"Caballero et al., 2023"}),")."]}),(0,n.jsx)(c.A,{src:"./img/55h_Image_36.png",alt:"Enter image alt description",number:"24",label:"1.24",caption:"A Broken Neural Scaling Law example (dark black solid line) (with 3 breaks where purple dotted lines intersect with dark black solid line) contains 4 individual power law segments (where the dashed lines that are yellow, blue, red, and green overlap with the dark black solid line). The 1st and 2nd break are very smooth; the 3rd break is very sharp ([Caballero et al., 2023](https://arxiv.org/abs/2210.14891))."})]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"How do training and inference scaling differ?"})," Training scaling involves using more compute during initial model training by using larger models, training for longer, or using bigger datasets. Another way that we might not be accounting for using scaling laws, is called inference time scaling. This instead uses more compute at runtime through techniques like chain-of-thought prompting, repeated sampling, or tree search. For example, you can either train a very large model that generates high-quality outputs directly, or train a smaller model that achieves similar performance by using more computation to think through problems step by step at inference time."]}),"\n",(0,n.jsx)(t.h2,{id:"03",children:"Scaling Hypothesis"}),"\n",(0,n.jsx)(h.A,{term:"Strong Scaling Hypothesis",source:"([Gwern, 2020](https://gwern.net/scaling-hypothesis))",number:"4",label:"1.4",children:(0,n.jsxs)(t.p,{children:["The strong scaling hypothesis proposes that simply scaling up current ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation model"})})," architectures with more compute and data will be sufficient to reach transformative AI capabilities and potentially even ASI."]})}),"\n",(0,n.jsx)(o.A,{src:"https://ourworldindata.org/grapher/ai-performance-knowledge-tests-vs-training-computation?tab=chart",width:"100%",height:"600px",loading:"lazy",allow:"web-share; clipboard-write",frameBorder:"0",number:"13",label:"1.13",caption:"Artificial intelligence: Performance on knowledge tests vs. training computation. Performance on knowledge tests is measured with the MMLU benchmark, here with 5-shot learning, which gauges a model\u2019s accuracy after receiving only five examples for each task. Training computation is measured in total petaFLOP, which is 10e15 floating-point operations ([Giattino et al., 2023](https://ourworldindata.org/artificial-intelligence))."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What is the strong scaling hypothesis?"})," This view suggests we already have all the fundamental components needed - it's just a matter of making them bigger, following established scaling laws. (",(0,n.jsx)(t.a,{href:"https://gwern.net/scaling-hypothesis",children:"Branwen, 2020"}),") There is heated debate around this hypothesis and we can't possibly cover every argument. We can give you a slight overview in the next few paragraphs."]}),"\n",(0,n.jsxs)(t.p,{children:["Proponents include OpenAI (",(0,n.jsx)(t.a,{href:"https://openai.com/blog/planning-for-agi-and-beyond",children:"OpenAI, 2023"}),"), Anthropic\u2019s CEO Dario Amodei (",(0,n.jsx)(t.a,{href:"https://www.dwarkeshpatel.com/p/dario-amodei",children:"Amodei, 2023"}),"), Conjecture (",(0,n.jsx)(t.a,{href:"https://www.lesswrong.com/posts/PE22QJSww8mpwh7bt/agi-in-sight-our-look-at-the-game-board",children:"Conjecture, 2023"}),"), DeepMind\u2019s safety team (",(0,n.jsx)(t.a,{href:"https://www.lesswrong.com/posts/GctJD5oCDRxCspEaZ/clarifying-ai-x-risk",children:"DeepMind, 2022"}),'), and others. According to the DeepMind team, there are "',(0,n.jsxs)(t.em,{children:["not many more fundamental innovations needed for AGI. Scaled-up ",(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:(0,n.jsx)(a,{term:"deep learning",definition:'{"definition":"A subset of machine learning using neural networks with multiple hidden layers to learn complex patterns in data.","source":"","aliases":["Deep Learning","DL"]}',children:"deep learning"})})," ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation models"})})," with RL from human feedback (RLHF) ",(0,n.jsx)(a,{term:"fine-tuning",definition:'{"definition":"The process of taking a pre-trained model and further training it on a specific task or dataset.","source":"","aliases":["Fine-tuning","fine-tune","finetuning","finetune"]}',children:(0,n.jsx)(a,{term:"fine-tuning",definition:'{"definition":"The process of taking a pre-trained model and further training it on a specific task or dataset.","source":"","aliases":["Fine-tuning","fine-tune","finetuning","finetune"]}',children:"fine-tuning"})})," [should suffice]"]}),'" (',(0,n.jsx)(t.a,{href:"https://www.lesswrong.com/posts/GctJD5oCDRxCspEaZ/clarifying-ai-x-risk",children:"DeepMind, 2022"}),")."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What are the key arguments supporting the strong scaling hypothesis?"})," The most compelling evidence for this view comes from empirical observations of progress in recent years. Researchers have been developing algorithms that follow the bitter lesson's principle for many years (focusing on general methods that leverage compute effectively). But even when researchers have developed sophisticated algorithms following the bitter lesson's principles, these improvements still only account for 35% of performance gains in language models in 2024, with the remaining 65% coming purely from increased scale in compute and data (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2403.05812",children:"Ho et al., 2024"}),"). Basically, even when our algorithmic improvements align perfectly with the bitter lesson, they're still far less important than raw scaling."]}),"\n",(0,n.jsxs)(t.p,{children:["The emergence of unexpected capabilities provides another powerful argument for strong scaling. We've seen previous generations of ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation models"})})," demonstrate remarkable abilities that weren't explicitly trained for, like programming for example. This emergent behavior hints that it is not impossible for higher-order cognitive abilities to similarly emerge simply as a function of scale. We see that bigger models become increasingly sample efficient - they require fewer examples to learn new tasks. This improved efficiency with scale suggests that scaling up further could eventually lead to human-like ",(0,n.jsx)(a,{term:"few-shot learning",definition:'{"definition":"The ability of a model to quickly adapt to new tasks with only a few examples, often demonstrated by providing examples in the input prompt.","source":"","aliases":["Few-shot Learning","few shot","k-shot learning","in-context learning"]}',children:(0,n.jsx)(a,{term:"few-shot learning",definition:'{"definition":"The ability of a model to quickly adapt to new tasks with only a few examples, often demonstrated by providing examples in the input prompt.","source":"","aliases":["Few-shot Learning","few shot","k-shot learning","in-context learning"]}',children:"few-shot learning"})})," capabilities, which is a precursor for TAI and ASI. Finally, these models also appear to be capable of learning any task that can be expressed through their training modalities. Right now this is text for LLMs but there is a clear path forward to ",(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:"multimodal"})})," LMMs. Since text can express virtually any human-comprehensible task, scaling up language understanding might be sufficient for general intelligence."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What are the key arguments against the strong scaling hypothesis?"})," Recent research has also identified several challenges to the strong scaling hypothesis. The most immediate is data availability - language models will likely exhaust high-quality public text data between 2026 and 2032 (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2211.04325",children:"Villalobos et al., 2024"}),"). While synthetic data might help address this limitation, it's unclear whether it can provide the same quality of learning signal as organic human-generated content. Alternatively, we still have a lot of ",(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:"multi-modal"})})," data left to train on (like YouTube videos) despite running out of text data."]}),"\n",(0,n.jsxs)(t.p,{children:['A more fundamental challenge comes from the way these models work. LLMs are fundamentally "interpolative databases" (or stochastic parrots , or a variety of other similar terms). The point being that they just build up a vast collection of vector transformations through ',(0,n.jsx)(a,{term:"pre-training",definition:'{"definition":"The initial training phase where a model learns general representations from a large dataset before being adapted to specific tasks.","source":"","aliases":["Pre-training","pretraining"]}',children:(0,n.jsx)(a,{term:"pre-training",definition:'{"definition":"The initial training phase where a model learns general representations from a large dataset before being adapted to specific tasks.","source":"","aliases":["Pre-training","pretraining"]}',children:"pre-training"})}),". While these transformations become increasingly sophisticated with scale, critics argue there's a fundamental difference between recombining existing ideas and true synthesis - deriving novel solutions from first principles. However, this is not an airtight case against strong scaling. This could simply be a limitation of current scale - a larger model trained on ",(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:(0,n.jsx)(a,{term:"multimodal",definition:'{"definition":"Relating to AI systems that can process and understand multiple types of data (such as text, images, audio, video) simultaneously.","source":"","aliases":["Multimodal","multi-modal","multimodality"]}',children:"multimodal"})})," data might learn to handle any new novel situation simply as a recombination of previously memorized patterns. So, it is unclear if template recombination actually does have an upper bound."]}),"\n",(0,n.jsx)(h.A,{term:"Weak Scaling Hypothesis",source:"([Gwern, 2020](https://gwern.net/scaling-hypothesis))",number:"5",label:"1.5",children:(0,n.jsx)(t.p,{children:"The weak scaling hypothesis proposes that even though scale will continue to be the primary driver of progress, we will also need targeted architectural and algorithmic improvements to overcome specific bottlenecks."})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What is the weak scaling hypothesis?"})," Given these challenges, a weaker version of the scaling hypothesis has also been proposed. According to the weak scaling hypothesis even though scale will continue to be the primary driver of progress, we will also need targeted architectural and algorithmic improvements to overcome specific bottlenecks. These improvements wouldn't require fundamental breakthroughs, but rather incremental enhancements to better leverage scale. (",(0,n.jsx)(t.a,{href:"https://gwern.net/scaling-hypothesis",children:"Branwen, 2020"}),") Similar to the strong scaling hypothesis, the weak one is also contentious and debated. We can provide a few of the results arguing both for and against this outlook."]}),"\n",(0,n.jsxs)(t.p,{children:["LeCun's H-Jepa architecture (",(0,n.jsx)(t.a,{href:"https://openreview.net/pdf?id=BZ5a1r-kVsf",children:"LeCun, 2022"}),"), or Richard Sutton\u2019s Alberta Plan (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2208.11173",children:"Sutton, 2022"}),") are notable plans adopting the weak scaling hypothesis."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What are the key arguments supporting the weak scaling hypothesis?"})," The arguments for strong scaling, like algorithmic improvements only contributing 35% of performance gains in language models can also count for weak scaling. Since one third is still a non-trivial role to play in capabilities improvement. Some more empirical observations also support weak scaling. Like hardware support for lower-precision calculations, which provided order-of-magnitude performance improvements for ",(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:"machine learning"})})," workloads (",(0,n.jsx)(t.a,{href:"https://epoch.ai/blog/trends-in-machine-learning-hardware",children:"Hobbhahn et al., 2023"}),"). These kinds of targeted improvements don't change the fundamental scaling story but rather help us better leverage available resources.. This suggests that there is still room for improvement through better scaling strategies rather than fundamental breakthroughs. (",(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2203.15556",children:"Hoffmann et al., 2022"}),")"]}),"\n",(0,n.jsx)(c.A,{src:"./img/BMs_Image_38.png",alt:"Enter image alt description",number:"25",label:"1.25",caption:"Augmentation/Scaffolding stays constant, but if the scaling hypothesis, weak or strong, is true, then capabilities will keep improving just by scaling."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"What if neither the weak nor the strong scaling hypothesis is true?"})," Essentially, both the scaling laws (which only predict ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation model"})}),' capabilities) and most debates around "scale is all you need" often miss other aspects of AI development that happen outside the scope of what scaling laws can predict. They don\'t account for improvements in AI "scaffolding" (like chain-of-thought prompting, tool use, or retrieval), or combinations of multiple models working together in novel ways. Debates around the scaling laws only tell us about the capabilities of a single ',(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation model"})})," trained in a standard way. For example, by the strong scaling hypothesis we can reach TAI by simply scaling up the same ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation model"})})," until it completely automates ",(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:(0,n.jsx)(a,{term:"machine learning",definition:'{"definition":"A field of artificial intelligence focused on building systems that learn and improve from data without being explicitly programmed for every task.","source":"","aliases":["Machine Learning","ML"]}',children:"ML"})})," R&D. But even if scaling stops, halting capabilities progress on the core ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation model"})})," (in either a weak or a strong way), the external techniques that leverage the existing model can still continue advancing."]}),"\n",(0,n.jsxs)(t.p,{children:["Think of ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation models"})}),' like LLMs or LMMs as simply one transistor. Alone they might not be able to do much, but if we combine enough transistors we end up with all the capabilities of a supercomputer. Many researchers think that this is a core element where future capabilities will come from. It is also referred to as "unhobbling" (',(0,n.jsx)(t.a,{href:"https://situational-awareness.ai/from-gpt-4-to-agi/#Unhobbling",children:"Aschenbrenner, 2024"}),'), "schlep" (',(0,n.jsx)(t.a,{href:"https://www.planned-obsolescence.org/scale-schlep-and-systems/",children:"Cotra, 2023"}),") and various other terms, but all of them point to the same underlying principle - raw scaling of single model performance is only one part of overall AI capability advancement."]}),"\n",(0,n.jsx)(c.A,{src:"./img/c42_Image_39.png",alt:"Enter image alt description",number:"26",label:"1.26",caption:"Even if we see no improvements in model scale, other elicitation techniques and scaffolding can keep improving. So overall capabilities keep growing. Realistically, the future is probably going to see both improvement due to scaffolding and scale. So for now, there does not seem to be an upper limit on improving capabilities as long as either one of the two holds."}),"\n",(0,n.jsxs)(t.p,{children:["We go deeper into the arguments and counterarguments for all views on scaling ",(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:(0,n.jsx)(a,{term:"foundation model",definition:'{"definition":"A large-scale model trained on diverse data that serves as a base for adaptation to various downstream tasks, typically through fine-tuning or prompting.","source":"[Bommasani et al., 2021](https://arxiv.org/abs/2108.07258)","aliases":["Foundation Model","foundation models","base model"]}',children:"foundation models"})})," in the appendix."]}),"\n",(0,n.jsxs)(d.A,{title:"Argument: Against scaling hypotheses - Memorization vs Synthesis",collapsed:!0,children:[(0,n.jsxs)(t.p,{children:["When we talk about LLMs as \"interpolative databases\", we're referring to how they store and manipulate vector programs - these shouldn\u2019t be confused with traditional computer programs like python or C++. These templates, or vector programs are transformations in the model's ",(0,n.jsx)(a,{term:"embedding",definition:'{"definition":"A dense vector representation of discrete objects (like words or tokens) in a continuous vector space that captures semantic relationships.","source":"","aliases":["Embedding","word embedding","embeddings","vector representation","vector embeddings"]}',children:(0,n.jsx)(a,{term:"embedding",definition:'{"definition":"A dense vector representation of discrete objects (like words or tokens) in a continuous vector space that captures semantic relationships.","source":"","aliases":["Embedding","word embedding","embeddings","vector representation","vector embeddings"]}',children:"embedding"})})," space. Early work on ",(0,n.jsx)(a,{term:"embedding",definition:'{"definition":"A dense vector representation of discrete objects (like words or tokens) in a continuous vector space that captures semantic relationships.","source":"","aliases":["Embedding","word embedding","embeddings","vector representation","vector embeddings"]}',children:(0,n.jsx)(a,{term:"embedding",definition:'{"definition":"A dense vector representation of discrete objects (like words or tokens) in a continuous vector space that captures semantic relationships.","source":"","aliases":["Embedding","word embedding","embeddings","vector representation","vector embeddings"]}',children:"embeddings"})})," showed simple transformations (like king - man + woman = queen), but modern LLMs can store millions of much more complex transformations. But due to a function of scale, LLMs can now store arbitrarily complex vector functions \u2014 so complex, in fact, that researchers found it more accurate to refer to them as vector programs rather than functions."]}),(0,n.jsxs)(t.p,{children:["So what's happening in LLMs is that they build up a vast database of these vector programs through ",(0,n.jsx)(a,{term:"pre-training",definition:'{"definition":"The initial training phase where a model learns general representations from a large dataset before being adapted to specific tasks.","source":"","aliases":["Pre-training","pretraining"]}',children:(0,n.jsx)(a,{term:"pre-training",definition:'{"definition":"The initial training phase where a model learns general representations from a large dataset before being adapted to specific tasks.","source":"","aliases":["Pre-training","pretraining"]}',children:"pre-training"})}),'. When we say they\'re doing "template matching" or "memorization", what we really mean is that they\'re storing millions of these vector transformations that they can retrieve and combine with each prompt.']}),(0,n.jsx)(t.p,{children:"So the deciding question for/against strong (and even weak scaling) becomes - Is this type of template program combination enough to reach general intelligence. In other words can program synthesis be approximated using recombinations of enough templates (also called abstractions and many other words but the key idea is the same)?"}),(0,n.jsxs)(t.p,{children:['People who argue against this say that no matter how numerous or sophisticated, are fundamentally different from true program synthesis. True program synthesis would mean deriving a new solution from first principles - not just recombining existing transformations. There are some empirical observations to support this view. Like the Caesar cipher example: "LLMs can solve a Caesar cipher with key size 3 or 5, but fail with key size 13, because they\'ve memorized specific solutions rather than understanding the general algorithm" (',(0,n.jsx)(t.a,{href:"https://www.youtube.com/watch?v=nL9jEy99Nh0",children:"Chollet, 2024"}),'). Or alternatively, the "reversal curse" which shows that even SOTA language models in 2024 cannot do reverse causal inference - if they are trained on "A is B" they fail to learn "B is A" (',(0,n.jsx)(t.a,{href:"https://arxiv.org/abs/2309.12288",children:"Berglund et al., 2023"}),")"]}),(0,n.jsxs)(t.p,{children:["But this does still not seem to completely invalidate scaling as of yet. If we scale up the size of the program database and cram more knowledge and patterns into it, we are going to be increasing its performance (",(0,n.jsx)(t.a,{href:"https://www.dwarkeshpatel.com/p/francois-chollet",children:"Chollet, 2024"}),"). Both sides of the debate agree on this. So this suggests the real issue isn't whether template recombination has an obvious absolute upper bound, but whether it's the most efficient path to general intelligence. Program synthesis might achieve the same capabilities with far less compute and data by learning to derive solutions rather than memorizing patterns."]})]})]})}function b(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(f,{...e})}):f(e)}},3989:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(6540),n=a(6347),s=a(8444);const o={iframeContainer:"iframeContainer_ixkI",loader:"loader_gjvK",spinner:"spinner_L1j2",spin:"spin_rtC2",iframeWrapper:"iframeWrapper_Tijy",iframe:"iframe_UAfa",caption:"caption_mDwB",captionLink:"captionLink_Ly4l"};var r=a(4848);function l(e){let{src:t,caption:a,title:l="Embedded content",height:d="500px",width:h="100%",chapter:c,number:m,label:p}=e;const[u,g]=(0,i.useState)(!0),f=(0,n.zy)(),b=c||(()=>{const e=f.pathname.match(/\/chapters\/(\d+)/);return e?parseInt(e[1]):null})(),w=d&&"100%"!==d&&"auto"!==d;return(0,r.jsxs)("figure",{className:o.iframeContainer,children:[u&&(0,r.jsxs)("div",{className:o.loader,children:[(0,r.jsx)("div",{className:o.spinner}),(0,r.jsx)("p",{children:"Loading content..."})]}),(0,r.jsx)("div",{className:o.iframeWrapper,style:{paddingBottom:w?"0":"56.25%",height:w?d:"auto"},children:(0,r.jsx)("iframe",{src:t,title:l,width:h,height:w?d:"100%",frameBorder:"0",allowFullScreen:!0,loading:"lazy",onLoad:()=>{g(!1)},className:o.iframe,style:{height:w?d:"100%",position:w?"static":"absolute"}})}),(0,r.jsx)(s.A,{caption:a,mediaType:"iframe",chapter:b,number:m,label:p})]})}},3931:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(6540),n=a(6347),s=a(8444);const o={videoFigure:"videoFigure_dV9u",fullWidth:"fullWidth_Tv7O",videoContainer:"videoContainer_LWoK",aspectRatio169:"aspectRatio169_Go8b",aspectRatio43:"aspectRatio43_b3T7",aspectRatio11:"aspectRatio11_n21J",aspectRatio219:"aspectRatio219_L_3n",videoIframe:"videoIframe_QEc5",videoElement:"videoElement_uu7N",customPlayer:"customPlayer_jiC4",customPlayerPlaceholder:"customPlayerPlaceholder_aL9q",loadingOverlay:"loadingOverlay_e2pu",spinner:"spinner_tFyL",spin:"spin_saPs",errorContainer:"errorContainer_J6Pn",errorIcon:"errorIcon_cGdn",fallbackLink:"fallbackLink_WsZk"};var r=a(4848);function l(e){let{type:t="youtube",videoId:a,caption:l,title:d,startTime:h,autoplay:c=!1,controls:m=!0,aspectRatio:p="16:9",width:u,height:g,chapter:f,number:b,label:w,useCustomPlayer:y=!1,fullWidth:v=!0}=e;const[x,j]=(0,i.useState)(!0),[k,A]=(0,i.useState)(!1),L=(0,n.zy)(),T=f||(()=>{const e=L.pathname.match(/\/chapters\/(\d+)/);return e?parseInt(e[1]):null})(),I=(()=>{const e=(e=>{if(!e)return"";if("number"==typeof e)return e.toString();if("string"==typeof e){if(/^\d+$/.test(e))return e;let t=0;const a=e.match(/(\d+)h/),i=e.match(/(\d+)m/),n=e.match(/(\d+)s/);return a&&(t+=3600*parseInt(a[1])),i&&(t+=60*parseInt(i[1])),n&&(t+=parseInt(n[1])),t>0?t.toString():""}return""})(h);switch(t.toLowerCase()){case"youtube":let i=`https://www.youtube.com/embed/${a}`;const n=new URLSearchParams;e&&n.append("start",e),c&&n.append("autoplay","1"),m||y||n.append("controls","0"),n.append("rel","0"),n.append("modestbranding","1"),n.append("fs","1"),n.append("cc_load_policy","0"),n.append("iv_load_policy","3"),n.append("showinfo","0"),n.append("disablekb","1"),n.append("playsinline","1"),n.append("color","white"),n.append("theme","light"),y&&(n.append("enablejsapi","1"),n.append("origin",window.location.origin));const s=n.toString();return s?`${i}?${s}`:i;case"vimeo":let o=`https://player.vimeo.com/video/${a}`;const r=new URLSearchParams;c&&r.append("autoplay","1"),m||y||r.append("controls","0"),r.append("title","0"),r.append("byline","0"),r.append("portrait","0"),r.append("dnt","1"),r.append("transparent","0"),r.append("background","1");const l=r.toString();return l?`${o}?${l}`:o;case"mp4":case"webm":case"video":return a;default:return console.warn(`Unsupported video type: ${t}`),a}})(),M=()=>{j(!1)},S=()=>{A(!0),j(!1)},_=e=>{let{src:a,onLoad:i,onError:n}=e;return(0,r.jsx)("div",{className:o.customPlayer,children:(0,r.jsxs)("div",{className:o.customPlayerPlaceholder,children:[(0,r.jsx)("h3",{children:"Atlas Custom Player"}),(0,r.jsx)("p",{children:"Coming Soon"}),(0,r.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:o.fallbackLink,children:["Watch on ",t.charAt(0).toUpperCase()+t.slice(1)]})]})})},B=["mp4","webm","video"].includes(t.toLowerCase());return(0,r.jsxs)("figure",{className:`${o.videoFigure} ${v?o.fullWidth:""}`,children:[(0,r.jsxs)("div",{className:`${o.videoContainer} ${(()=>{switch(p){case"4:3":return o.aspectRatio43;case"1:1":return o.aspectRatio11;case"21:9":return o.aspectRatio219;default:return o.aspectRatio169}})()}`,style:{width:v?"100%":u||"auto",maxWidth:v?"none":"800px"},children:[x&&!k&&(0,r.jsxs)("div",{className:o.loadingOverlay,children:[(0,r.jsx)("div",{className:o.spinner}),(0,r.jsx)("p",{children:"Loading video..."})]}),k&&(0,r.jsxs)("div",{className:o.errorContainer,children:[(0,r.jsxs)("svg",{className:o.errorIcon,width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,r.jsx)("h4",{children:"Failed to load video"}),(0,r.jsxs)("p",{children:["Video type: ",t]}),(0,r.jsxs)("p",{children:["Video ID/URL: ",a]}),(0,r.jsx)("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:o.fallbackLink,children:"Try opening video directly"})]}),!k&&(B?(0,r.jsxs)("video",{className:o.videoElement,controls:m,autoPlay:c,onLoadedData:M,onError:S,title:d||l||`${t} video`,style:{width:u||"100%",height:g||"auto",display:x?"none":"block"},children:[(0,r.jsx)("source",{src:I,type:`video/${t}`}),(0,r.jsxs)("p",{children:["Your browser doesn't support video playback.",(0,r.jsx)("a",{href:I,target:"_blank",rel:"noopener noreferrer",children:"Download the video file"})]})]}):y?(0,r.jsx)(_,{src:I,onLoad:M,onError:S}):(0,r.jsx)("iframe",{className:o.videoIframe,src:I,title:d||l||`${t} video`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,onLoad:M,onError:S,style:{width:u||"100%",height:g||"100%",opacity:x?0:1}}))]}),(0,r.jsx)(s.A,{caption:l,mediaType:"video",chapter:T,number:b,label:w})]})}}}]);